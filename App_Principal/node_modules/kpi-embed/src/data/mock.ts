// src/data/mock.ts
// Si tenés tipos, podés tipar: `: Dataset`
import { buildPowerFromIsOn } from "../utils/energy";
export const MOCK_DATA = {
  generated_at: "2025-09-18T12:00:00",
  org: { id: 1, name: "MUNICIPALIDAD RDLS" },
  kpis: {
    assets_total: 10,
    tanks: 3,
    pumps: 3,
    valves: 2,
    manifolds: 1,
    alarms_active: 1,
    alarms_critical_active: 0,
    avg_flow_lpm_30d: 83.2,
    avg_level_pct_30d: 61.5,
  },
  locations: [
    { location_id: 10, location_code: "PT-PLANTA", location_name: "Planta Principal" },
    { location_id: 20, location_code: "PT-NORTE", location_name: "Pozo Norte" },
    { location_id: 30, location_code: "PT-SUR", location_name: "Pozo Sur" },
    { location_id: 40, location_code: "DEP-CENTRO", location_name: "Depósito Centro" },
  ],
  byLocation: [
    {
      location_id: 10,
      location_code: "PT-PLANTA",
      location_name: "Planta Principal",
      assets_total: 5,
      tanks_count: 1,
      pumps_count: 1,
      valves_count: 1,
      manifolds_count: 1,
      alarms_active: 1,
      alarms_critical_active: 0,
      pump_readings_30d: 48,
      avg_flow_lpm_30d: 88.3,
      avg_pressure_bar_30d: 2.6,
      pumps_last_seen: "2025-09-18T12:00:00",
      tank_readings_30d: 48,
      avg_level_pct_30d: 63.4,
      tanks_last_seen: "2025-09-18T12:00:00",
    },
    {
      location_id: 20,
      location_code: "PT-NORTE",
      location_name: "Pozo Norte",
      assets_total: 2,
      tanks_count: 1,
      pumps_count: 1,
      valves_count: 1,
      manifolds_count: 0,
      alarms_active: 0,
      alarms_critical_active: 0,
      pump_readings_30d: 48,
      avg_flow_lpm_30d: 79.1,
      avg_pressure_bar_30d: 2.4,
      pumps_last_seen: "2025-09-18T12:00:00",
      tank_readings_30d: 48,
      avg_level_pct_30d: 58.2,
      tanks_last_seen: "2025-09-18T12:00:00",
    },
    {
      location_id: 30,
      location_code: "PT-SUR",
      location_name: "Pozo Sur",
      assets_total: 2,
      tanks_count: 1,
      pumps_count: 1,
      valves_count: 0,
      manifolds_count: 0,
      alarms_active: 0,
      alarms_critical_active: 0,
      pump_readings_30d: 48,
      avg_flow_lpm_30d: 82.2,
      avg_pressure_bar_30d: 2.5,
      pumps_last_seen: "2025-09-18T12:00:00",
      tank_readings_30d: 48,
      avg_level_pct_30d: 62.0,
      tanks_last_seen: "2025-09-18T12:00:00",
    },
    {
      location_id: 40,
      location_code: "DEP-CENTRO",
      location_name: "Depósito Centro",
      assets_total: 1,
      tanks_count: 0,
      pumps_count: 0,
      valves_count: 0,
      manifolds_count: 0,
      alarms_active: 0,
      alarms_critical_active: 0,
      pump_readings_30d: 0,
      avg_flow_lpm_30d: null,
      avg_pressure_bar_30d: null,
      pumps_last_seen: null,
      tank_readings_30d: 0,
      avg_level_pct_30d: null,
      tanks_last_seen: null,
    },
  ],
  assets: {
    tanks: [
      { id: 1, name: "Tank 1", capacity_liters: 50000, location_id: 10, fluid: "Agua Potable" },
      { id: 2, name: "Tank 2", capacity_liters: 30000, location_id: 20, fluid: "Agua Potable" },
      { id: 3, name: "Tank 3", capacity_liters: 45000, location_id: 30, fluid: "Agua Cruda" },
    ],
    pumps: [
      { id: 101, name: "Bomba A", rated_kw: 7.5, drive_type: "vfd", location_id: 10, group_id: 1 },
      { id: 102, name: "Bomba B", rated_kw: 5.5, drive_type: "soft", location_id: 20, group_id: 1 },
      { id: 103, name: "Bomba C", rated_kw: 11.0, drive_type: "direct", location_id: 30, group_id: 2 },
    ],
    valves: [
      { id: 201, name: "Válvula 1", default_state: "open", diameter_mm: 80, location_id: 10 },
      { id: 202, name: "Válvula 2", default_state: "closed", diameter_mm: 100, location_id: 20 },
    ],
    manifolds: [{ id: 301, name: "Colector Principal", location_id: 10 }],
  },
  latest: {
    tanks: [
      { tank_id: 1, ts: "2025-09-18T12:00:00", level_percent: 67.4, volume_l: 33700, temperature_c: 18.1 },
      { tank_id: 2, ts: "2025-09-18T12:00:00", level_percent: 55.1, volume_l: 16530, temperature_c: 17.6 },
      { tank_id: 3, ts: "2025-09-18T12:00:00", level_percent: 62.0, volume_l: 27900, temperature_c: 16.9 },
    ],
    pumps: [
      {
        pump_id: 101,
        ts: "2025-09-18T12:00:00",
        is_on: true,
        flow_lpm: 92.4,
        pressure_bar: 2.7,
        voltage_v: 380,
        current_a: 12.3,
        control_mode: "auto",
        manual_lockout: false,
      },
      {
        pump_id: 102,
        ts: "2025-09-18T12:00:00",
        is_on: false,
        flow_lpm: 0,
        pressure_bar: 0.5,
        voltage_v: 0,
        current_a: 0,
        control_mode: "auto",
        manual_lockout: false,
      },
      {
        pump_id: 103,
        ts: "2025-09-18T12:00:00",
        is_on: true,
        flow_lpm: 88.1,
        pressure_bar: 2.6,
        voltage_v: 380,
        current_a: 18.0,
        control_mode: "auto",
        manual_lockout: false,
      },
    ],
  },
  timeseries: {
    tanks: {
      "1": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        level_percent: Array.from({ length: 24 }).map(
          (_, i) => 60 + Math.round(8 * Math.sin(i / 3) + (Math.random() * 4 - 2))
        ),
        volume_l: Array.from({ length: 24 }).map((_, i) => Math.round(50000 * (0.5 + Math.sin(i / 12) * 0.1))),
        temperature_c: Array.from({ length: 24 }).map((_, i) => 16 + Math.round(10 * Math.sin(i / 10))),
      },
      "2": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        level_percent: Array.from({ length: 24 }).map(
          (_, i) => 55 + Math.round(6 * Math.sin(i / 2) + (Math.random() * 3 - 1.5))
        ),
        volume_l: Array.from({ length: 24 }).map((_, i) => Math.round(30000 * (0.4 + Math.sin(i / 9) * 0.08))),
        temperature_c: Array.from({ length: 24 }).map((_, i) => 17 + Math.round(8 * Math.sin(i / 9))),
      },
      "3": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        level_percent: Array.from({ length: 24 }).map(
          (_, i) => 62 + Math.round(5 * Math.sin(i / 2.5) + (Math.random() * 2 - 1))
        ),
        volume_l: Array.from({ length: 24 }).map((_, i) => Math.round(45000 * (0.45 + Math.sin(i / 8) * 0.07))),
        temperature_c: Array.from({ length: 24 }).map((_, i) => 16 + Math.round(7 * Math.sin(i / 8))),
      },
    },
    pumps: {
      "101": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        is_on: Array.from({ length: 24 }).map((_, i) => (i % 6) < 3),
      },
      "102": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        is_on: Array.from({ length: 24 }).map((_, i) => (i % 7) < 2),
      },
      "103": {
        timestamps: Array.from({ length: 24 }).map((_, i) => `2025-09-17T${(i + 1).toString().padStart(2, "0")}:00:00`),
        is_on: Array.from({ length: 24 }).map((_, i) => (i % 5) < 3),
      },
    },
  },
  analytics30d: {
    pump_uptime: {
      "101": { pump_id: 101, pump_name: "Bomba A", on_seconds: 12 * 3600, total_seconds: 24 * 3600, uptime_pct_30d: 50.0 },
      "102": { pump_id: 102, pump_name: "Bomba B", on_seconds: 8 * 3600, total_seconds: 24 * 3600, uptime_pct_30d: 33.3 },
      "103": { pump_id: 103, pump_name: "Bomba C", on_seconds: 15 * 3600, total_seconds: 24 * 3600, uptime_pct_30d: 62.5 },
    },
    pump_energy_kwh: {
      "101": { pump_id: 101, kwh_30d: 62.3 },
      "102": { pump_id: 102, kwh_30d: 41.8 },
      "103": { pump_id: 103, kwh_30d: 108.6 },
    },
  },
  topology: {
    edges: [
      {
        id: 1,
        from_type: "tank",
        from_id: 1,
        from_name: "Tank 1",
        to_type: "pump",
        to_id: 101,
        to_name: "Bomba A",
        pipe_diameter_mm: 80,
        length_m: 35,
        is_active: true,
        from_location_id: 10,
        to_location_id: 10,
      },
      {
        id: 2,
        from_type: "pump",
        from_id: 101,
        from_name: "Bomba A",
        to_type: "manifold",
        to_id: 301,
        to_name: "Colector Principal",
        pipe_diameter_mm: 100,
        length_m: 20,
        is_active: true,
        from_location_id: 10,
        to_location_id: 10,
      },
    ],
    nodes: [
      { type: "tank", asset_id: 1, name: "Tank 1", code: "T-001", level_ratio: 0.67, capacity_liters: 50000, location_id: 10 },
      { type: "pump", asset_id: 101, name: "Bomba A", code: "P-101", pump_status: "on", rated_kw: 7.5, location_id: 10 },
      { type: "valve", asset_id: 201, name: "Válvula 1", code: "V-201", valve_state: "open", location_id: 10 },
      { type: "manifold", asset_id: 301, name: "Colector Principal", code: "M-301", location_id: 10 },
    ],
  },
  alarms: [
    {
      id: 1666,
      asset_type: "tank",
      asset_id: 1,
      code: "LOW",
      severity: "warning",
      message: "Tank 1 LOW",
      ts_raised: "2025-09-15T02:00:00",
      is_active: true,
      extra: { value: 28.0, threshold: "low" },
    },
    {
      id: 1667,
      asset_type: "tank",
      asset_id: 1,
      code: "LEVEL",
      severity: "critical",
      message: "Nivel 100% ≥ 80.00% (Muy alto)",
      ts_raised: "2025-09-17T08:00:00",
      is_active: false,
      extra: { level_percent: 100, threshold: "very_high" },
    },
  ],
} as const;
buildPowerFromIsOn(MOCK_DATA);